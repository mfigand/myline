jQuery(document).ready(function($) {

    var pathname = window.location.pathname.split('/');
    var user_id = pathname[pathname.length-1];
  
    var avatarImgAttr = $('#avatar').attr('data-imageSrc');
    var avatarImgSrc = 'url('+avatarImgAttr+')'

    var coverImgAttr_1 = $('#header-wrapper').attr('data-imageSrc');
    var coverImgSrc_1 = 'url('+coverImgAttr_1+')';

    // var coverImgAttr_2 = $('#cover2').attr('data-imageSrc');
    // var coverImgSrc_2 = 'url('+coverImgAttr_2+')';

    $('#avatar').css("background-image", avatarImgSrc);
    avatarImgAttr != "" ? $('#avatar').show() : $('#avatar').hidden();

    $('#header-wrapper.header-slider').css("background-image", coverImgSrc_1);

    // $('#section.spacer.bg3').css("background-image", coverImgSrc_2);

  $('#avatar').on('click', function(){
    window.location.replace("/users/edit");
  });

  $("#header-wrapper").hover(startHover, endHover);

  function startHover() {
      $('#update-cover').show();
  }

  function endHover() {
      $('#update-cover').hide();
  }

  $('#update-cover').on('click',function(e){
    debugger
    // display modal
  })

  $('#about-description').on('blur', function(e){

    var content = e.target.innerText;
    var contextId = $(this).data('usercontext');

    if (contextId != false ) {
      var verb = "PUT";
      var url = "/users/"+ user_id +"/contexts/"+contextId
    }else{
      var ver = "POST"
      var url = "/users/"+ user_id +"/contexts"

    }
    
    $.ajax({
      type: verb,
      url: url,
      data: { 
        context:{
          // coverPicture: '/bg/bg-barriga.jpg', 
          aboutDescription: content, 
          // aboutPicture: '', 
          // aboutVideo: '', 
          // parallaxPicture: '/bg/bg-beach.jpg', 
          user_id: user_id
        },
        commit: "Save",
        controller: "contexts",
        action: "create",
        user_id: user_id
      },
    }).done(function( data ) {
      debugger
    }).fail(function( jqXHR, textStatus ) {
      jqXHR.responseText
      var response = jqXHR.responseText;
      debugger
    })

  });

});
